<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A modern Fortran simulated annealing optimization method">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>simulated_annealing_type &ndash; simulated-annealing </title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">simulated-annealing </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../sourcefile/simulated_annealing.f90.html">Source File</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>simulated_annealing_type
      <small>Derived Type</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title="<p>100.0% of total for derived types.</p>Including implementation: 401 statements, 100.0% of total for derived types.">32 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/simulated_annealing.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/simulated_annealing.f90.html'>simulated_annealing.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/simulated_annealing_module.html'>simulated_annealing_module</a></li>
            <li class="breadcrumb-item active" aria-current="page">simulated_annealing_type</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-n">n</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-maximize">maximize</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-eps">eps</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-ns">ns</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-nt">nt</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-neps">neps</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-maxevl">maxevl</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-use_initial_guess">use_initial_guess</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-n_resets">n_resets</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-lb">lb</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-ub">ub</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-c">c</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-iprint">iprint</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-iseed1">iseed1</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-iseed2">iseed2</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-step_mode">step_mode</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-vms">vms</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-iunit">iunit</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-optimal_f_specified">optimal_f_specified</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-optimal_f">optimal_f</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-optimal_f_tol">optimal_f_tol</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#variable-fcn">fcn</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#boundprocs-0"
         aria-expanded="false" aria-controls="boundprocs-0">
         <h4 class="card-header bg-primary text-white">Type-Bound Procedures</h4>
      </a>
      <div id="boundprocs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../type/simulated_annealing_type.html#boundprocedure-initialize">initialize</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#boundprocedure-optimize">optimize</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#boundprocedure-destroy">destroy</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#boundprocedure-func">func</a>
            <a class="list-group-item" href="../type/simulated_annealing_type.html#boundprocedure-perturb_and_evaluate">perturb_and_evaluate</a>
        </div>
      </div>
    </div>

  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../type/simulated_annealing_type.html#src">simulated_annealing_type</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2 id="type-def-statement">
        type, public :: simulated_annealing_type</h2>
    
    <br>

    <section>
    <h2>Components</h2>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-n"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
<td> =</td>
                <td>0</td>
            <td>
                <p>number of variables in the function to be optimized.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maximize"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maximize</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
                <p>denotes whether the function should be maximized or minimized.
a true value denotes maximization while a false value denotes
minimization.  intermediate output (see iprint) takes this into
account.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eps"></span>
              real(kind=wp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eps</strong></td>
<td> =</td>
                <td>1.0e-9_wp</td>
            <td>
                <p>error tolerance for termination. if the final function
values from the last neps temperatures differ from the
corresponding value at the current temperature by less than
eps and the final function value at the current temperature
differs from the current optimal function value by less than
eps, execution terminates and ier = 0 is returned.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ns"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ns</strong></td>
<td> =</td>
                <td>20</td>
            <td>
                <p>number of cycles.  after ns function evaluations, each element of
vm is adjusted according to the input <code>step_mode</code>
the suggested value is 20.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-nt"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>nt</strong></td>
<td> =</td>
                <td>100</td>
            <td>
                <p>number of iterations before temperature reduction. after
nt<em>ns function evaluations, temperature (t) is changed
by the factor rt.  value suggested by corana et al. is
max(100, 5</em>n).  see goffe et al. for further advice.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-neps"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>neps</strong></td>
<td> =</td>
                <td>4</td>
            <td>
                <p>number of final function values used to decide upon
termination.  see eps.  suggested value is 4.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxevl"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxevl</strong></td>
<td> =</td>
                <td>10000</td>
            <td>
                <p>the maximum number of function evaluations.  if it is
exceeded, ier = 1.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-use_initial_guess"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>use_initial_guess</strong></td>
<td> =</td>
                <td>.true.</td>
            <td>
                <p>if false, the initial guess is ignored and a
random point in the bounds is used for the first
function evaluation</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n_resets"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>n_resets</strong></td>
<td> =</td>
                <td>2</td>
            <td>
                <p>number of times to run the main loop (must be &gt;=1)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lb"></span>
              real(kind=wp),
            </td>
              <td>private,</td>
            <td>
              dimension(:), allocatable
            </td>
            <td>::</td>
            <td><strong>lb</strong></td>
                <td></td>
                <td></td>
            <td>
                <p>the lower bound for the allowable solution variables.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ub"></span>
              real(kind=wp),
            </td>
              <td>private,</td>
            <td>
              dimension(:), allocatable
            </td>
            <td>::</td>
            <td><strong>ub</strong></td>
                <td></td>
                <td></td>
            <td>
                <p>the upper bound for the allowable solution variables.
if the algorithm chooses x(i) &lt; lb(i) or x(i) &gt; ub(i),
i = 1, n, a point is from inside is randomly selected. this
this focuses the algorithm on the region inside ub and lb.
unless the user wishes to concentrate the search to a particular
region, ub and lb should be set to very large positive
and negative values, respectively.  note that the starting
vector x should be inside this region.  also note that lb and
ub are fixed in position, while vm is centered on the last
accepted trial set of variables that optimizes the function.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-c"></span>
              real(kind=wp),
            </td>
              <td>private,</td>
            <td>
              dimension(:), allocatable
            </td>
            <td>::</td>
            <td><strong>c</strong></td>
                <td></td>
                <td></td>
            <td>
                <p>vector that controls the step length adjustment.  the suggested
value for all elements is 2.0.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iprint"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iprint</strong></td>
<td> =</td>
                <td>1</td>
            <td>
                <p>controls printing inside <a href="../proc/sa.html">sa</a>:</p>
<ul>
<li>0 - nothing printed.</li>
<li>1 - function value for the starting value and
   summary results before each temperature
   reduction. this includes the optimal
   function value found so far, the total
   number of moves (broken up into uphill,
   downhill, accepted and rejected), the
   number of out of bounds trials, the
   number of new optima found at this
   temperature, the current optimal x and
   the step length vm. note that there are
   n<em>ns</em>nt function evalutations before each
   temperature reduction. finally, notice is
   is also given upon achieveing the termination
   criteria.</li>
<li>2 - each new step length (vm), the current optimal
   x (xopt) and the current trial x (x). this
   gives the user some idea about how far x
   strays from xopt as well as how vm is adapting
   to the function.</li>
<li>3 - each function evaluation, its acceptance or
   rejection and new optima. for many problems,
   this option will likely require a small tree
   if hard copy is used. this option is best
   used to learn about the algorithm. a small
   value for maxevl is thus recommended when
   using iprint = 3.</li>
</ul>
<p>suggested value: 1
note: for a given value of iprint, the lower valued
options (other than 0) are utilized.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iseed1"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iseed1</strong></td>
<td> =</td>
                <td>1234</td>
            <td>
                <p>the first seed for the random number generator.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iseed2"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iseed2</strong></td>
<td> =</td>
                <td>5678</td>
            <td>
                <p>the second seed for the random number generator.
different values for iseed1 and iseed2 will lead
to an entirely different sequence of trial points
and decisions on downhill moves (when maximizing).
see goffe et al. on how this can be used to test
the results of <a href="../proc/sa.html">sa</a>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-step_mode"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>step_mode</strong></td>
<td> =</td>
                <td>1</td>
            <td>
                <p>how to vary <code>vm</code> after <code>ns</code> cycles.</p>
<ul>
<li>1 : original method: adjust vm so that approximately
  half of all evaluations are accepted</li>
<li>2 : keep vm constant</li>
<li>3 : adjust by a constant <code>vms</code> factor</li>
</ul>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-vms"></span>
              real(kind=wp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>vms</strong></td>
<td> =</td>
                <td>0.1_wp</td>
            <td>
                <p>for <code>step_mode=3</code>, the factor to adjust <code>vm</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iunit"></span>
              integer,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>iunit</strong></td>
<td> =</td>
                <td>output_unit</td>
            <td>
                <p>unit number for prints.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-optimal_f_specified"></span>
              logical,
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>optimal_f_specified</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
                <p>if the optional <code>f</code> value is known,
it can be specified by <code>optimal_f</code>.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-optimal_f"></span>
              real(kind=wp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>optimal_f</strong></td>
<td> =</td>
                <td>0.0_wp</td>
            <td>
                <p>if <code>optimal_f_specified=True</code> the solver will stop
if this value is achieved.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-optimal_f_tol"></span>
              real(kind=wp),
            </td>
              <td>private</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>optimal_f_tol</strong></td>
<td> =</td>
                <td>0.0_wp</td>
            <td>
                <p>absolute tolerance for the <code>optimal_f</code> check</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-fcn"></span>
              procedure(<a href='../interface/sa_func.html'>sa_func</a>),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>fcn</strong></td>
<td>=&gt; </td>
                <td>null()</td>
            <td>
                <p>the user's function</p>
            </td>
        </tr>
    </tbody>
  </table>

    </section>
    <br>
    


      <section>
        <h2>Type-Bound Procedures</h2>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-initialize"></span>
      <h3>
          procedure, public ::
  <strong>initialize</strong> => <a href='/home/runner/work/simulated-annealing/simulated-annealing/doc/proc/initialize_sa.html'>initialize_sa</a>
        
      </h3>
    </div>
      <ul class="list-group">
          <li class="list-group-item">
                    <h3>
    private  subroutine <a href='../proc/initialize_sa.html'>initialize_sa</a>(me, fcn, n, lb, ub, c, maximize, eps, ns, nt, neps, maxevl, iprint, iseed1, iseed2, step_mode, vms, iunit, use_initial_guess, n_resets, optimal_f_specified, optimal_f, optimal_f_tol)  
</h3>
    

  <p>Initialize the class.</p><a href="../proc/initialize_sa.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='simulated_annealing_type.html'>simulated_annealing_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              procedure(<a href='../interface/sa_func.html'>sa_func</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fcn</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(n)
            </td>
            <td>::</td>
            <td><strong>lb</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(n)
            </td>
            <td>::</td>
            <td><strong>ub</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td>optional,</td>            <td>
              dimension(n)
            </td>
            <td>::</td>
            <td><strong>c</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>maximize</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>eps</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ns</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nt</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>neps</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxevl</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iprint</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iseed1</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iseed2</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>step_mode</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>vms</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iunit</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>use_initial_guess</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>n_resets</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>optimal_f_specified</strong></td>
            <td>
<p>if the optional <code>f</code> value is known,
it can be specified by <code>optimal_f</code>.
[Default is False]</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>optimal_f</strong></td>
            <td>
<p>if <code>optimal_f_specified=True</code> the solver will stop
if this value is achieved.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>optimal_f_tol</strong></td>
            <td>
<p>absolute tolerance for the <code>optimal_f</code> check</p>
            </td>
        </tr>
    </tbody>
  </table>


          </li>
      </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-optimize"></span>
      <h3>
          procedure, public ::
  <strong>optimize</strong> => <a href='/home/runner/work/simulated-annealing/simulated-annealing/doc/proc/sa.html'>sa</a>
        
      </h3>
    </div>
      <ul class="list-group">
          <li class="list-group-item">
                    <h3>
    private  subroutine <a href='../proc/sa.html'>sa</a>(me, x, rt, t, vm, xopt, fopt, nacc, nfcnev, ier)  
</h3>
    

  <p>Continuous simulated annealing global optimization algorithm</p><a href="../proc/sa.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='simulated_annealing_type.html'>simulated_annealing_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(me%n)
            </td>
            <td>::</td>
            <td><strong>x</strong></td>
            <td>
<p>on input: the starting values for the variables of the
function to be optimized. [Will be replaced by final point]</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rt</strong></td>
            <td>
<p>the temperature reduction factor.  the value suggested by
corana et al. is .85. see goffe et al. for more advice.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>t</strong></td>
            <td>
<p>on input, the initial temperature. see goffe et al. for advice.
on output, the final temperature. Note that if <code>t=0</code>, then
all downhill steps will be rejected</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(inout),</td>
              <td></td>            <td>
              dimension(me%n)
            </td>
            <td>::</td>
            <td><strong>vm</strong></td>
            <td>
<p>the step length vector. on input it should encompass the region of
interest given the starting value x.  for point x(i), the next
trial point is selected is from x(i) - vm(i)  to  x(i) + vm(i).
since vm is adjusted so that about half of all points are accepted,
the input value is not very important (i.e. is the value is off,
sa adjusts vm to the correct value).</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              dimension(me%n)
            </td>
            <td>::</td>
            <td><strong>xopt</strong></td>
            <td>
<p>the variables that optimize the function.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fopt</strong></td>
            <td>
<p>the optimal value of the function.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nacc</strong></td>
            <td>
<p>the number of accepted function evaluations.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nfcnev</strong></td>
            <td>
<p>the total number of function evaluations. in a minor
point, note that the first evaluation is not used in the
core of the algorithm; it simply initializes the
algorithm.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ier</strong></td>
            <td>
<p>the error return number:</p><a href="../proc/sa.html#variable-ier" class="pull-right"><emph>Read more&hellip;</emph></a>
            </td>
        </tr>
    </tbody>
  </table>


          </li>
      </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-destroy"></span>
      <h3>
          procedure, public ::
  <strong>destroy</strong> => <a href='/home/runner/work/simulated-annealing/simulated-annealing/doc/proc/destroy_sa.html'>destroy_sa</a>
        
      </h3>
    </div>
      <ul class="list-group">
          <li class="list-group-item">
                    <h3>
    private  subroutine <a href='../proc/destroy_sa.html'>destroy_sa</a>(me)  
</h3>
    

  <p>Destructor.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='simulated_annealing_type.html'>simulated_annealing_type</a>),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>


          </li>
      </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-func"></span>
      <h3>
          procedure, private ::
  <strong>func</strong>
        
      </h3>
    </div>
      <ul class="list-group">
          <li class="list-group-item">
                    <h3>
    private pure function <a href='../proc/func.html'>func</a>(me, f)  
</h3>
    

  <p>if the function is to be minimized, switch the sign of the function.
note that all intermediate and final output switches the sign back
to eliminate any possible confusion for the user.</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='simulated_annealing_type.html'>simulated_annealing_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>f</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=wp)</small>
    </h4>
    

          </li>
      </ul>
  </div>

          </div>
          <div class="row">
              <div class="card mt-3">
    <div class="card-header codesum">
      <span class="anchor" id="boundprocedure-perturb_and_evaluate"></span>
      <h3>
          procedure, private ::
  <strong>perturb_and_evaluate</strong>
        
      </h3>
    </div>
      <ul class="list-group">
          <li class="list-group-item">
                    <h3>
    private  subroutine <a href='../proc/perturb_and_evaluate.html'>perturb_and_evaluate</a>(me, x, vm, xp, fp, nfcnev, ier, first)  
</h3>
    

  <p>Perturb the <code>x</code> vector and evaluate the function.</p><a href="../proc/perturb_and_evaluate.html" class="pull-right"><emph>Read more&hellip;</emph></a>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" ></span>
              class(<a href='simulated_annealing_type.html'>simulated_annealing_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>me</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>x</strong></td>
            <td>
<p>input optimization variable vector to perturb</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(in),</td>
              <td></td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>vm</strong></td>
            <td>
<p>step length vector</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(out),</td>
              <td></td>            <td>
              dimension(:)
            </td>
            <td>::</td>
            <td><strong>xp</strong></td>
            <td>
<p>the perturbed <code>x</code> value</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              real(kind=wp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>fp</strong></td>
            <td>
<p>the value of the user function at <code>xp</code></p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>nfcnev</strong></td>
            <td>
<p>total number of function evaluations</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              integer,
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ier</strong></td>
            <td>
<p>status output code</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" ></span>
              logical,
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>first</strong></td>
            <td>
<p>to use the input <code>x</code> the first time</p>
            </td>
        </tr>
    </tbody>
  </table>


          </li>
      </ul>
  </div>

          </div>
      </section>

    <section>
    <h3><span class="anchor" id="src"></span>Source Code</h3>
    <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">type</span><span class="p">,</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">simulated_annealing_type</span>

<span class="w">        </span><span class="k">private</span>

<span class="k">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">              </span><span class="c">!! number of variables in the function to be optimized.</span>
<span class="w">        </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maximize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!! denotes whether the function should be maximized or minimized.</span>
<span class="w">                                      </span><span class="c">!! a true value denotes maximization while a false value denotes</span>
<span class="w">                                      </span><span class="c">!! minimization.  intermediate output (see iprint) takes this into</span>
<span class="w">                                      </span><span class="c">!! account.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0e-9_wp</span><span class="w">   </span><span class="c">!! error tolerance for termination. if the final function</span>
<span class="w">                                      </span><span class="c">!! values from the last neps temperatures differ from the</span>
<span class="w">                                      </span><span class="c">!! corresponding value at the current temperature by less than</span>
<span class="w">                                      </span><span class="c">!! eps and the final function value at the current temperature</span>
<span class="w">                                      </span><span class="c">!! differs from the current optimal function value by less than</span>
<span class="w">                                      </span><span class="c">!! eps, execution terminates and ier = 0 is returned.</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">ns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="w">           </span><span class="c">!! number of cycles.  after ns function evaluations, each element of</span>
<span class="w">                                      </span><span class="c">!! vm is adjusted according to the input `step_mode`</span>
<span class="w">                                      </span><span class="c">!! the suggested value is 20.</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">nt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w">          </span><span class="c">!! number of iterations before temperature reduction. after</span>
<span class="w">                                      </span><span class="c">!! nt*ns function evaluations, temperature (t) is changed</span>
<span class="w">                                      </span><span class="c">!! by the factor rt.  value suggested by corana et al. is</span>
<span class="w">                                      </span><span class="c">!! max(100, 5*n).  see goffe et al. for further advice.</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">neps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w">          </span><span class="c">!! number of final function values used to decide upon</span>
<span class="w">                                      </span><span class="c">!! termination.  see eps.  suggested value is 4.</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">maxevl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10000</span><span class="w">    </span><span class="c">!! the maximum number of function evaluations.  if it is</span>
<span class="w">                                      </span><span class="c">!! exceeded, ier = 1.</span>

<span class="w">        </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">use_initial_guess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"> </span><span class="c">!! if false, the initial guess is ignored and a</span>
<span class="w">                                              </span><span class="c">!! random point in the bounds is used for the first</span>
<span class="w">                                              </span><span class="c">!! function evaluation</span>

<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n_resets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="c">!! number of times to run the main loop (must be &gt;=1)</span>

<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lb</span><span class="w">        </span><span class="c">!! the lower bound for the allowable solution variables.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ub</span><span class="w">        </span><span class="c">!! the upper bound for the allowable solution variables.</span>
<span class="w">                                                        </span><span class="c">!! if the algorithm chooses x(i) &lt; lb(i) or x(i) &gt; ub(i),</span>
<span class="w">                                                        </span><span class="c">!! i = 1, n, a point is from inside is randomly selected. this</span>
<span class="w">                                                        </span><span class="c">!! this focuses the algorithm on the region inside ub and lb.</span>
<span class="w">                                                        </span><span class="c">!! unless the user wishes to concentrate the search to a particular</span>
<span class="w">                                                        </span><span class="c">!! region, ub and lb should be set to very large positive</span>
<span class="w">                                                        </span><span class="c">!! and negative values, respectively.  note that the starting</span>
<span class="w">                                                        </span><span class="c">!! vector x should be inside this region.  also note that lb and</span>
<span class="w">                                                        </span><span class="c">!! ub are fixed in position, while vm is centered on the last</span>
<span class="w">                                                        </span><span class="c">!! accepted trial set of variables that optimizes the function.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:),</span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">c</span><span class="w">         </span><span class="c">!! vector that controls the step length adjustment.  the suggested</span>
<span class="w">                                                        </span><span class="c">!! value for all elements is 2.0.</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iprint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">           </span><span class="c">!! controls printing inside [[sa]]:</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!!  * 0 - nothing printed.</span>
<span class="w">                                        </span><span class="c">!!  * 1 - function value for the starting value and</span>
<span class="w">                                        </span><span class="c">!!    summary results before each temperature</span>
<span class="w">                                        </span><span class="c">!!    reduction. this includes the optimal</span>
<span class="w">                                        </span><span class="c">!!    function value found so far, the total</span>
<span class="w">                                        </span><span class="c">!!    number of moves (broken up into uphill,</span>
<span class="w">                                        </span><span class="c">!!    downhill, accepted and rejected), the</span>
<span class="w">                                        </span><span class="c">!!    number of out of bounds trials, the</span>
<span class="w">                                        </span><span class="c">!!    number of new optima found at this</span>
<span class="w">                                        </span><span class="c">!!    temperature, the current optimal x and</span>
<span class="w">                                        </span><span class="c">!!    the step length vm. note that there are</span>
<span class="w">                                        </span><span class="c">!!    n*ns*nt function evalutations before each</span>
<span class="w">                                        </span><span class="c">!!    temperature reduction. finally, notice is</span>
<span class="w">                                        </span><span class="c">!!    is also given upon achieveing the termination</span>
<span class="w">                                        </span><span class="c">!!    criteria.</span>
<span class="w">                                        </span><span class="c">!!  * 2 - each new step length (vm), the current optimal</span>
<span class="w">                                        </span><span class="c">!!    x (xopt) and the current trial x (x). this</span>
<span class="w">                                        </span><span class="c">!!    gives the user some idea about how far x</span>
<span class="w">                                        </span><span class="c">!!    strays from xopt as well as how vm is adapting</span>
<span class="w">                                        </span><span class="c">!!    to the function.</span>
<span class="w">                                        </span><span class="c">!!  * 3 - each function evaluation, its acceptance or</span>
<span class="w">                                        </span><span class="c">!!    rejection and new optima. for many problems,</span>
<span class="w">                                        </span><span class="c">!!    this option will likely require a small tree</span>
<span class="w">                                        </span><span class="c">!!    if hard copy is used. this option is best</span>
<span class="w">                                        </span><span class="c">!!    used to learn about the algorithm. a small</span>
<span class="w">                                        </span><span class="c">!!    value for maxevl is thus recommended when</span>
<span class="w">                                        </span><span class="c">!!    using iprint = 3.</span>
<span class="w">                                        </span><span class="c">!!</span>
<span class="w">                                        </span><span class="c">!! suggested value: 1</span>
<span class="w">                                        </span><span class="c">!! note: for a given value of iprint, the lower valued</span>
<span class="w">                                        </span><span class="c">!! options (other than 0) are utilized.</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iseed1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1234</span><span class="w">    </span><span class="c">!! the first seed for the random number generator.</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iseed2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5678</span><span class="w">    </span><span class="c">!! the second seed for the random number generator.</span>
<span class="w">                                    </span><span class="c">!! different values for iseed1 and iseed2 will lead</span>
<span class="w">                                    </span><span class="c">!! to an entirely different sequence of trial points</span>
<span class="w">                                    </span><span class="c">!! and decisions on downhill moves (when maximizing).</span>
<span class="w">                                    </span><span class="c">!! see goffe et al. on how this can be used to test</span>
<span class="w">                                    </span><span class="c">!! the results of [[sa]].</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">step_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c">!! how to vary `vm` after `ns` cycles.</span>
<span class="w">                                    </span><span class="c">!!</span>
<span class="w">                                    </span><span class="c">!! * 1 : original method: adjust vm so that approximately</span>
<span class="w">                                    </span><span class="c">!!   half of all evaluations are accepted</span>
<span class="w">                                    </span><span class="c">!! * 2 : keep vm constant</span>
<span class="w">                                    </span><span class="c">!! * 3 : adjust by a constant `vms` factor</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">vms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1_wp</span><span class="w">         </span><span class="c">!! for `step_mode=3`, the factor to adjust `vm`</span>
<span class="w">        </span><span class="kt">integer</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">iunit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">output_unit</span><span class="w">  </span><span class="c">!! unit number for prints.</span>

<span class="w">        </span><span class="c">! option to specify the known answer, so the solver will stop if it finds it:</span>
<span class="w">        </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">optimal_f_specified</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!! if the optional `f` value is known,</span>
<span class="w">                                                 </span><span class="c">!! it can be specified by `optimal_f`.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">optimal_f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"> </span><span class="c">!! if `optimal_f_specified=True` the solver will stop</span>
<span class="w">                                       </span><span class="c">!! if this value is achieved.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">optimal_f_tol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"> </span><span class="c">!! absolute tolerance for the `optimal_f` check</span>

<span class="w">        </span><span class="k">procedure</span><span class="p">(</span><span class="n">sa_func</span><span class="p">),</span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fcn</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">null</span><span class="p">()</span><span class="w">  </span><span class="c">!! the user&#39;s function</span>

<span class="w">    </span><span class="k">contains</span>

<span class="k">        private</span>

<span class="k">        procedure</span><span class="p">,</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">initialize</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">initialize_sa</span>
<span class="w">        </span><span class="k">procedure</span><span class="p">,</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">optimize</span><span class="w">   </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">sa</span>
<span class="w">        </span><span class="k">procedure</span><span class="p">,</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">destroy</span><span class="w">    </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">destroy_sa</span>

<span class="w">        </span><span class="k">procedure</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">func</span>
<span class="w">        </span><span class="k">procedure</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">perturb_and_evaluate</span>

<span class="w">    </span><span class="k">end type </span><span class="n">simulated_annealing_type</span>
</pre></div>

    </section>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              simulated-annealing
 was developed by Jacob Williams<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>